<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>MyDFS: Riferimenti per il file Client/inc/Cache.h</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MyDFS
   &#160;<span id="projectnumber">1</span>
   </div>
   <div id="projectbrief">MyDistribuitedFileSystem</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generato da Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Cerca');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Pagina&#160;Principale</span></a></li>
      <li><a href="pages.html"><span>Pagine&#160;collegate</span></a></li>
      <li><a href="annotated.html"><span>Strutture&#160;dati</span></a></li>
      <li class="current"><a href="files.html"><span>File</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Cerca" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>Elenco&#160;dei&#160;file</span></a></li>
      <li><a href="globals.html"><span>Elementi&#160;globali</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Tutto</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Strutture dati</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>File</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Funzioni</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variabili</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Ridefinizioni di tipo (typedef)</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Tipi enumerati (enum)</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Valori del tipo enumerato</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Definizioni</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pagine</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_922c588100a187620fdc1533bc178f73.html">Client</a></li><li class="navelem"><a class="el" href="dir_ae8017259e19aa6e76c1027178a75206.html">inc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Funzioni</a>  </div>
  <div class="headertitle">
<div class="title">Riferimenti per il file Cache.h</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="Cache_8h_source.html">Vai al codice sorgente di questo file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Funzioni</h2></td></tr>
<tr class="memitem:ab85cfa2751c24894cd4bdca9254ed117"><td class="memItemLeft" align="right" valign="top">FILE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Cache_8h.html#ab85cfa2751c24894cd4bdca9254ed117">createTempFile</a> (char *basename)</td></tr>
<tr class="separator:ab85cfa2751c24894cd4bdca9254ed117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a403785c0f2573dd16d81eff4ab26c20d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Cache_8h.html#a403785c0f2573dd16d81eff4ab26c20d">readRequest</a> (<a class="el" href="structMyDFSId.html">MyDFSId</a> *id, int pos, int size, <a class="el" href="structCacheRequest.html">CacheRequest</a> *req)</td></tr>
<tr class="memdesc:a403785c0f2573dd16d81eff4ab26c20d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Usato per dire se il dato che voglio leggere si trova in cache oppure no.  <a href="#a403785c0f2573dd16d81eff4ab26c20d">Continua...</a><br /></td></tr>
<tr class="separator:a403785c0f2573dd16d81eff4ab26c20d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a686e517ab500f68c40c03bfbc3e2e2fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Cache_8h.html#a686e517ab500f68c40c03bfbc3e2e2fd">writeCache</a> (<a class="el" href="structMyDFSId.html">MyDFSId</a> *id, void *buffer, int size, int pos)</td></tr>
<tr class="memdesc:a686e517ab500f68c40c03bfbc3e2e2fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funzione che scrive nel file di cache il contenuto di una read, senza sovrascrivere le parti scritte da write locali.  <a href="#a686e517ab500f68c40c03bfbc3e2e2fd">Continua...</a><br /></td></tr>
<tr class="separator:a686e517ab500f68c40c03bfbc3e2e2fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Documentazione delle funzioni</h2>
<a class="anchor" id="ab85cfa2751c24894cd4bdca9254ed117"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FILE* createTempFile </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>basename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenziato da <a class="el" href="Prove_2Cache_2Cache_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main()</a>, e <a class="el" href="OPEN_8c.html#a846cf2a86ab9bdb1a8496e03b93d6db8">mydfs_open()</a>.</p>

</div>
</div>
<a class="anchor" id="a403785c0f2573dd16d81eff4ab26c20d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int readRequest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMyDFSId.html">MyDFSId</a> *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCacheRequest.html">CacheRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Usato per dire se il dato che voglio leggere si trova in cache oppure no. </p>
<dl class="section return"><dt>Restituisce</dt><dd>1 MISS: In caso di MISS, dentro a req verranno messi posizione e size del dato da scaricare. </dd>
<dd>
0 HIT: per interrompere il while, torna false.</dd></dl>
<p>Nota: La miss si riferisce ad un "buco", quindi bisogna chiamare la funzione piu' volte per assicurarsi che non ci siano altri miss. Nota2: Il lock e' in teoria troppo grande. In pratica pero', se fra la prima operazione di lettura e la seconda ci fosse una invalidazione della cache qualcosa di orrendo potrebbe accadere. </p>

<p>Referenzia <a class="el" href="structMyDFSId.html#a2b7cf19c5ac22e03ae8abf7e688fee2a">MyDFSId::filesize</a>, <a class="el" href="structWriteOp.html#ab10157ced397c43b41d1e77a6372a43c">WriteOp::next</a>, <a class="el" href="structReadOp.html#ac84186a2d784cb2fbd0c71dd7d5df78d">ReadOp::next</a>, <a class="el" href="structWriteOp.html#a0cd1c3d781c93b6feaaa5d01606fdc3d">WriteOp::pos</a>, <a class="el" href="structReadOp.html#a2615c975be53dbd950cb51959009257a">ReadOp::pos</a>, <a class="el" href="structCacheRequest.html#a9b1e1f0498ee02f22da75fe915334873">CacheRequest::pos</a>, <a class="el" href="structMyDFSId.html#a71f51c82d7133bfc16fcffeb4c395da0">MyDFSId::readListMutex</a>, <a class="el" href="Client_2Cache_8c.html#a403785c0f2573dd16d81eff4ab26c20d">readRequest()</a>, <a class="el" href="structWriteOp.html#af804d8a1e3d428ee7275b5e4f467d23a">WriteOp::size</a>, <a class="el" href="structReadOp.html#a4ed8bd364b1b3378cc6f4faf750da527">ReadOp::size</a>, e <a class="el" href="structCacheRequest.html#abc81e438c50064f3dde1835d6146bb1c">CacheRequest::size</a>.</p>

<p>Referenziato da <a class="el" href="Client_2READ_8c.html#aa4b63039ca9686f5666ce6bbb33317d7">mydfs_read()</a>, e <a class="el" href="Cache_8h.html#a403785c0f2573dd16d81eff4ab26c20d">readRequest()</a>.</p>

</div>
</div>
<a class="anchor" id="a686e517ab500f68c40c03bfbc3e2e2fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int writeCache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMyDFSId.html">MyDFSId</a> *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funzione che scrive nel file di cache il contenuto di una read, senza sovrascrivere le parti scritte da write locali. </p>
<p>Eseguo un ciclo che vede se il punto in cui:</p><ol type="1">
<li>Controllo se il punto in cui voglio scrivere e' contenuto in una operazione di write. In quel caso, richiamo questa funzione spostando avanti il puntatore del buffer</li>
<li>Il punto in cui voglio scrivere non e' incluso in nessuna write. In questo caso, vedo se c'e' una write inclusa nello spazio del buffer della read che voglio scrivere. Se e' cosi', scrivo quanto posso, e se posso scrivere altro dopo la sezione di write, richiamo questa funzione ricorsivamente aggiornado gli indici.</li>
</ol>
<p>Utilizzo pos, e vedo se e' contenuto in una write. Se si lo sposto fino alla fine della write, e richiamo questa funzione ricorsivamente. Raggiunto il caso base, cerco se c'e' una write contenuta fra pos e pos+size. Se e' così mi trovo la fine della write. Eseguo la scrittura e richiamo questa funzione ricorsivamente</p>
<dl class="section return"><dt>Restituisce</dt><dd>1 se tutto e' ok, 0 se qualcosa e' andata storta </dd></dl>

<p>Referenzia <a class="el" href="structMyDFSId.html#ae2badd91d3b506420a9e49554df8212d">MyDFSId::fp</a>, <a class="el" href="Client_2inc_2Utils_8h.html#a1f6240c9883eba86a3a1dc5e8ea77338">logM()</a>, <a class="el" href="structWriteOp.html#ab10157ced397c43b41d1e77a6372a43c">WriteOp::next</a>, <a class="el" href="structWriteOp.html#a0cd1c3d781c93b6feaaa5d01606fdc3d">WriteOp::pos</a>, <a class="el" href="structWriteOp.html#af804d8a1e3d428ee7275b5e4f467d23a">WriteOp::size</a>, e <a class="el" href="Client_2Cache_8c.html#a686e517ab500f68c40c03bfbc3e2e2fd">writeCache()</a>.</p>

<p>Referenziato da <a class="el" href="Client_2READ_8c.html#a0b8dfa171c3b5c784fb6cba643728110">readFrom()</a>, e <a class="el" href="Cache_8h.html#a686e517ab500f68c40c03bfbc3e2e2fd">writeCache()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generato da &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
